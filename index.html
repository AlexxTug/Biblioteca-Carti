<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Biblioteca Mea</title>
<style>
:root{
  --bg:#f5f7fa; --card:#fff; --text:#222; --accent:#4b3f72; --accent-hover:#6c5ca0; --muted:#666; --btn-bg:#4b3f72; --btn-color:#fff;
}
body.dark{ --bg:#12121a; --card:#1e1e2b; --text:#e6e6e6; --accent:#8b7cd1; --accent-hover:#a69bf0; --muted:#aaa; --btn-bg:#8b7cd1; --btn-color:#fff; }
body{margin:0;font-family:Inter,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);transition:background 0.4s ease, color 0.4s ease;}
.header{position:sticky;top:0;background:var(--card);display:flex;align-items:center;justify-content:space-between;padding:12px 18px;box-shadow:0 2px 10px rgba(0,0,0,0.06);z-index:50;transition:background 0.4s ease, box-shadow 0.4s ease;flex-wrap:wrap;}
.header-left h1{margin:0;font-size:28px;font-weight:700;color:var(--accent)}
.header-right{display:flex;align-items:center;gap:8px;flex-wrap:wrap;justify-content:flex-end}
.header-right input[type=text],.header-right select{height:36px;padding:6px 8px;border-radius:8px;border:1px solid #ccc;background:var(--card);color:var(--text);box-sizing:border-box;}
.header-right button{height:36px;padding:6px 12px;border-radius:8px;border:0;background:var(--btn-bg);color:var(--btn-color);cursor:pointer;transition:background .2s, color .2s}
.header-right button:hover{background:var(--accent-hover)}
.container{max-width:90%;margin:18px auto;padding:0 10px}
#addBookForm{display:none;margin-bottom:18px;background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.06);transition:background 0.4s ease;}
#addBookForm input,#addBookForm textarea,#addBookForm select{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;margin-bottom:10px;box-sizing:border-box;}
#books{display:flex;flex-direction:column;gap:14px}
.book{display:flex;gap:14px;padding:14px;border-radius:12px;background:var(--card);box-shadow:0 6px 18px rgba(0,0,0,0.04);align-items:flex-start;max-width:700px;margin:0 auto;flex-wrap:wrap}
.book img{width:110px;height:150px;object-fit:cover;border-radius:6px;flex-shrink:0}
.book-content{flex:1;min-width:180px}
.book-content h3{margin:0 0 6px;color:var(--accent)}
.book-content p{margin:6px 0;color:var(--muted)}
.stars{color:#f5a623;font-weight:600}
.actions{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
.actions button{padding:6px 10px;border-radius:6px;border:0;background:var(--btn-bg);color:var(--btn-color);cursor:pointer;transition:background .2s}
.actions button.ghost{background:transparent;color:var(--accent);border:1px solid #ddd}
.modal{display:none;position:fixed;inset:0;align-items:center;justify-content:center;background:rgba(0,0,0,0.5);}
.modal .card{background:var(--card);padding:18px;border-radius:12px;width:94%;max-width:520px;box-shadow:0 8px 20px rgba(0,0,0,0.3);}
.modal .card h3{margin-top:0;color:var(--accent)}
.modal .card input,.modal .card textarea{width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc;background:var(--card);color:var(--text);box-sizing:border-box}
.modal .card button{padding:8px 12px;border-radius:8px;margin-left:8px;border:0;background:var(--btn-bg);color:var(--btn-color)}
@media(max-width:600px){.header-left{flex-basis:100%;text-align:center;margin-bottom:8px}.header-right{flex-basis:100%;justify-content:space-between;flex-wrap:wrap}.header-right input,.header-right select{flex:1 1 48%;margin-bottom:6px}.header-right button{flex:1 1 48%;margin-bottom:6px}.book{flex-direction:column;align-items:center}.book img{width:100%;height:auto}.book-content{width:100%}}
</style>
</head>
<body>
<header class="header">
  <div class="header-left"><h1>üìö Biblioteca Mea</h1></div>
  <div class="header-right">
    <input id="search" type="text" placeholder="CautƒÉ titlu sau autor">
    <select id="filterRating">
      <option value="">Toate ratingurile</option>
      <option value="7">Peste 7</option>
      <option value="5">Peste 5</option>
    </select>
    <select id="sort">
      <option value="">SorteazƒÉ dupƒÉ</option>
      <option value="title">Titlu</option>
      <option value="author">Autor</option>
      <option value="rating">Rating</option>
    </select>
    <button id="showFormBtn">‚ûï AdaugƒÉ carte</button>
    <button id="toggleTheme" class="secondary">üåô</button>
  </div>
</header>
<main class="container">
  <form id="addBookForm">
    <input id="title" placeholder="Titlul cƒÉr»õii" required>
    <input id="author" placeholder="Autorul" required>
    <textarea id="review" rows="4" placeholder="Recenzia"></textarea>
    <label>Rating:</label>
    <select id="rating">
      <option value="1">‚≠ê</option>
      <option value="2">‚≠ê‚≠ê</option>
      <option value="3">‚≠ê‚≠ê‚≠ê</option>
      <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
    </select>
    <input id="cover" placeholder="URL copertƒÉ (op»õional)">
    <div style="text-align:right"><button type="submit">AdaugƒÉ cartea</button></div>
  </form>
  <section id="books"></section>
</main>
<div id="editModal" class="modal">
  <div class="card">
    <h3>EditeazƒÉ cartea</h3>
    <form id="editBookForm">
      <input id="editTitle" required>
      <input id="editAuthor" required>
      <textarea id="editReview" rows="4"></textarea>
      <label>Rating:</label>
      <select id="editRating">
        <option value="1">‚≠ê</option>
        <option value="2">‚≠ê‚≠ê</option>
        <option value="3">‚≠ê‚≠ê‚≠ê</option>
        <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="6">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="7">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="8">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="9">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
        <option value="10">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
      </select>
      <input id="editCover" placeholder="URL copertƒÉ (op»õional)">
      <div style="text-align:right"><button type="button" id="cancelEdit">AnuleazƒÉ</button><button type="submit">SalveazƒÉ</button></div>
    </form>
  </div>
</div>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
const firebaseConfig = { apiKey: "AIzaSyBaWRxJGw_Urngf3PCJEDliUHzr3AeuRZ4", authDomain: "biblioteca-carti.firebaseapp.com", projectId: "biblioteca-carti", storageBucket: "biblioteca-carti.firebasestorage.app", messagingSenderId: "371218386893", appId: "1:371218386893:web:4dc3632bfd7d0e74ccbe84" };
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const PASSWORD = "marrons";

const showFormBtn = document.getElementById('showFormBtn');
const addBookForm = document.getElementById('addBookForm');
const booksDiv = document.getElementById('books');
const toggleTheme = document.getElementById('toggleTheme');
const editModal = document.getElementById('editModal');
const editBookForm = document.getElementById('editBookForm');
const cancelEdit = document.getElementById('cancelEdit');
let currentBookId = null;

showFormBtn.addEventListener('click', () => { addBookForm.style.display = addBookForm.style.display === 'none' ? 'block' : 'none'; });
toggleTheme.addEventListener('click', () => { document.body.classList.toggle('dark'); });

async function loadBooks(){
  booksDiv.innerHTML='';
  const snapshot = await getDocs(collection(db,'books'));
  snapshot.forEach(docSnap=>{
    const b = docSnap.data();
    const div = document.createElement('div');
    div.className='book';
    const coverImg = b.cover ? `<img src='${b.cover}'>` : '';
    div.innerHTML=`${coverImg}<div class='book-content'><h3>${b.title}</h3><p><strong>${b.author}</strong></p><p>${b.review||''}</p><p class='stars'>${'‚≠ê'.repeat(b.rating||0)}${'‚òÜ'.repeat(10-(b.rating||0))} ${b.rating||0}/10</p><div class='actions'><button class='editBtn'>‚úèÔ∏è EditeazƒÉ</button><button class='deleteBtn ghost'>üóëÔ∏è »òterge</button></div></div>`;
    div.querySelector('.editBtn').addEventListener('click',()=>{
      const pw = prompt('Introdu parola pentru editare:');
      if(pw!==PASSWORD){alert('Parola incorectƒÉ'); return;}
      currentBookId = docSnap.id;
      document.getElementById('editTitle').value=b.title;
      document.getElementById('editAuthor').value=b.author;
      document.getElementById('editReview').value=b.review||'';
      document.getElementById('editRating').value=b.rating||1;
      document.getElementById('editCover').value=b.cover||'';
      editModal.style.display='flex';
    });
    div.querySelector('.deleteBtn').addEventListener('click',async()=>{
      const pw = prompt('Introdu parola pentru »ôtergere:');
      if(pw!==PASSWORD){alert('Parola incorectƒÉ'); return;}
      await deleteDoc(doc(db,'books',docSnap.id));
      loadBooks();
    });
    booksDiv.appendChild(div);
  });
}

addBookForm.addEventListener('submit',async e=>{
  e.preventDefault();
  const pw = prompt('Introdu parola pentru a adƒÉuga cartea:');
  if(pw!==PASSWORD){alert('Parola incorectƒÉ'); return;}
  await addDoc(collection(db,'books'),{
    title: document.getElementById('title').value,
    author: document.getElementById('author').value,
    review: document.getElementById('review').value,
    rating: parseInt(document.getElementById('rating').value),
    cover: document.getElementById('cover').value
  });
  addBookForm.reset(); addBookForm.style.display='none';
  loadBooks();
});

editBookForm.addEventListener('submit',async e=>{
  e.preventDefault();
  await updateDoc(doc(db,'books',currentBookId),{
    title: document.getElementById('editTitle').value,
    author: document.getElementById('editAuthor').value,
    review: document.getElementById('editReview').value,
    rating: parseInt(document.getElementById('editRating').value),
    cover: document.getElementById('editCover').value
  });
  editModal.style.display='none';
  loadBooks();
});
cancelEdit.addEventListener('click',()=>{editModal.style.display='none'});

loadBooks();
</script>
</body>
</html>
